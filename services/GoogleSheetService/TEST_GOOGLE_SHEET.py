"""
êµ¬ê¸€ ì‹œíŠ¸ í…ŒìŠ¤íŠ¸ íŒŒì¼
simple_google_sheetì„ ì‚¬ìš©í•œ ë²”ìš© ê¸°ë¡ í…ŒìŠ¤íŠ¸
"""

from simple_google_sheet import record, record_dict, SimpleGoogleSheet
from datetime import datetime
from dotenv import load_dotenv
import os
import time

# .env íŒŒì¼ ë¡œë“œ
load_dotenv()

def test_google_sheet():
    """êµ¬ê¸€ ì‹œíŠ¸ ë²”ìš© ê¸°ë¡ í…ŒìŠ¤íŠ¸"""

    # .envì—ì„œ ì‹œíŠ¸ ID ê°€ì ¸ì˜¤ê¸° (GOOGLE_SHEET_ID_1 ì‚¬ìš©)
    sheet_id = os.getenv('GOOGLE_SHEET_ID_1')
    if not sheet_id:
        print("âŒ GOOGLE_SHEET_ID_1ì´ .env íŒŒì¼ì— ì„¤ì •ë˜ì–´ ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.")
        return

    print("=" * 50)
    print("ğŸš€ êµ¬ê¸€ ì‹œíŠ¸ í…ŒìŠ¤íŠ¸ ì‹œì‘")
    print("=" * 50)

    # 1. ê°€ë³€ ì¸ì í…ŒìŠ¤íŠ¸ - ì›í•˜ëŠ” ë§Œí¼ ì¸ì ì „ë‹¬
    print("\n[í…ŒìŠ¤íŠ¸ 1: ê°€ë³€ ì¸ì]")
    record(sheet_id, "í…ŒìŠ¤íŠ¸1")
    record(sheet_id, "í…ŒìŠ¤íŠ¸2", "ë°ì´í„°A")
    record(sheet_id, "í…ŒìŠ¤íŠ¸3", "ë°ì´í„°A", "ë°ì´í„°B")
    record(sheet_id, "í…ŒìŠ¤íŠ¸4", "ë°ì´í„°A", "ë°ì´í„°B", "ë°ì´í„°C")
    record(sheet_id, "í…ŒìŠ¤íŠ¸5", "A", "B", "C", "D", "E", "F", "G")
    print("âœ… ê°€ë³€ ì¸ì í…ŒìŠ¤íŠ¸ ì™„ë£Œ")

    time.sleep(1)

    # 2. ê±°ë˜ ì‹œë®¬ë ˆì´ì…˜
    print("\n[í…ŒìŠ¤íŠ¸ 2: ê±°ë˜ ê¸°ë¡]")
    record(sheet_id, "ë§¤ìˆ˜", "ë¹„íŠ¸ì½”ì¸", "KRW-BTC", 140000000, 0.001, 140000)
    record(sheet_id, "ë§¤ë„", "ë¹„íŠ¸ì½”ì¸", "KRW-BTC", 145000000, 0.001, 145000, "+3.6%", "+5000")
    record(sheet_id, "ë§¤ìˆ˜", "ì´ë”ë¦¬ì›€", "KRW-ETH", 5000000, 0.1, 500000)
    record(sheet_id, "ë§¤ë„", "ì´ë”ë¦¬ì›€", "KRW-ETH", 4800000, 0.1, 480000, "-4.0%", "-20000")
    print("âœ… ê±°ë˜ ê¸°ë¡ ì™„ë£Œ")

    time.sleep(1)

    # 3. ì‹œìŠ¤í…œ ë¡œê·¸
    print("\n[í…ŒìŠ¤íŠ¸ 3: ì‹œìŠ¤í…œ ë¡œê·¸]")
    record(sheet_id, "ì‹œìŠ¤í…œ", "ì‹œì‘", "Argos v1.0")
    record(sheet_id, "API", "ì—°ê²°", "ì—…ë¹„íŠ¸", "ì„±ê³µ")
    record(sheet_id, "ì—ëŸ¬", "API", "Rate limit", "429", "1ë¶„ ëŒ€ê¸°")
    record(sheet_id, "ì•Œë¦¼", "ìŠ¬ë™", "ë©”ì‹œì§€ ì „ì†¡", "ì„±ê³µ")
    print("âœ… ì‹œìŠ¤í…œ ë¡œê·¸ ì™„ë£Œ")

    time.sleep(1)

    # 4. ë”•ì…”ë„ˆë¦¬ ê¸°ë¡ (í—¤ë” ìë™ ê´€ë¦¬)
    print("\n[í…ŒìŠ¤íŠ¸ 4: ë”•ì…”ë„ˆë¦¬ ê¸°ë¡]")
    record_dict(sheet_id, {
        "ì¢…ëª©": "ë¦¬í”Œ",
        "ì‹¬ë³¼": "KRW-XRP",
        "ê±°ë˜": "ë§¤ìˆ˜",
        "ê°€ê²©": 3500,
        "ìˆ˜ëŸ‰": 100,
        "ê¸ˆì•¡": 350000
    })

    record_dict(sheet_id, {
        "ì¢…ëª©": "ì†”ë¼ë‚˜",
        "ì‹¬ë³¼": "KRW-SOL",
        "ê±°ë˜": "ë§¤ë„",
        "ê°€ê²©": 250000,
        "ìˆ˜ëŸ‰": 2,
        "ê¸ˆì•¡": 500000,
        "ìˆ˜ìµë¥ ": "+5.2%",
        "ë©”ëª¨": "ëª©í‘œê°€ ë„ë‹¬"
    })

    # ìƒˆë¡œìš´ í•„ë“œ ì¶”ê°€ í…ŒìŠ¤íŠ¸
    record_dict(sheet_id, {
        "ì¢…ëª©": "ì¹´ë¥´ë‹¤ë…¸",
        "ì‹¬ë³¼": "KRW-ADA",
        "ê±°ë˜": "ë§¤ìˆ˜",
        "ê°€ê²©": 800,
        "ìˆ˜ëŸ‰": 1000,
        "ê¸ˆì•¡": 800000,
        "RSI": 28.5,  # ìƒˆ í•„ë“œ
        "ë³¼ë¥¨": 12345678  # ìƒˆ í•„ë“œ
    })
    print("âœ… ë”•ì…”ë„ˆë¦¬ ê¸°ë¡ ì™„ë£Œ")

    # 5. ì¼ì¼ ìš”ì•½
    print("\n[í…ŒìŠ¤íŠ¸ 5: ì¼ì¼ ìš”ì•½]")
    record(sheet_id, "="*20, "ì¼ì¼ ìš”ì•½", "="*20)
    record(sheet_id, "ê±°ë˜íšŸìˆ˜", "15", "ìŠ¹ë¥ ", "60%", "ìˆ˜ìµê¸ˆ", "+125,000ì›")
    print("âœ… ì¼ì¼ ìš”ì•½ ì™„ë£Œ")

    # URL ì¶œë ¥
    sheet = SimpleGoogleSheet(sheet_id=sheet_id)
    print(f"\nğŸ“± êµ¬ê¸€ ì‹œíŠ¸ URL: {sheet.get_sheet_url()}")
    print("âœ… êµ¬ê¸€ ì‹œíŠ¸ì—ì„œ í™•ì¸í•˜ì„¸ìš”!")

    print("\n" + "=" * 50)
    print("âœ¨ ëª¨ë“  í…ŒìŠ¤íŠ¸ ì™„ë£Œ!")
    print("=" * 50)


if __name__ == "__main__":
    test_google_sheet()